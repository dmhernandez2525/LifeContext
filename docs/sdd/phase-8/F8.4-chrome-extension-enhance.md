# F8.4 Chrome Extension Enhancement - SDD

## Overview
Enhanced the Chrome extension with a settings panel, auto-export scheduling via Chrome Alarms API, configurable history lookback, selective data type export, and last-export tracking.

## Changes

### `apps/extension/manifest.json`
- Bumped version to 1.1.0
- Added `alarms` permission for scheduled auto-export

### `apps/extension/background.js`
- Added settings management via `chrome.storage.local` with defaults for history days, auto-export, and data type toggles
- Added `getSettings`, `saveSettings`, `getLastExportInfo`, `recordExport` functions
- Refactored message listener to use handler lookup table instead of if-chain
- Added auto-export alarm management via `chrome.alarms` API (daily/weekly/monthly intervals)
- Alarm handler runs export based on settings, stores result in `chrome.storage.local` for web app pickup
- `onInstalled` handler now sets default settings on install and restores alarms on update

### `apps/extension/popup.html`
- Added settings gear button in header
- Added settings panel with toggle visibility (hidden/active classes)
- Settings panel includes: history lookback dropdown (1/3/5/10 years), per-type export toggles, auto-export toggle with frequency selector
- Added last-export timestamp display
- Refined styling: smaller cards, compact layout

### `apps/extension/popup.js`
- Added `loadSettings()` on popup open to hydrate UI from stored settings
- Added `applySettingsToUI()` to sync toggles and selects with current settings
- Added `handleToggle()` for toggle buttons with data-key binding
- Added `updateSetting()` for persisting individual setting changes
- Added `loadLastExport()` to display last export timestamp
- Export now filters data types based on settings before creating JSON blob
- Settings panel show/hide with count refresh on return

## Architecture Decisions
- Settings persisted in `chrome.storage.local` to survive service worker restarts
- Auto-export stores data in `chrome.storage.local` under `latestAutoExport` key, allowing the web app to detect and import new data
- Alarm intervals use Chrome Alarms API which respects minimum interval limits
- Export filtering happens at popup level, keeping background.js export functions reusable
- Removed hardcoded `localhost:3000` redirect from export flow for production readiness
