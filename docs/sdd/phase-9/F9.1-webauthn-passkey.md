# F9.1 WebAuthn/Passkey Support - SDD

## Overview
Added WebAuthn credential registration and authentication for passwordless unlock via fingerprint, face recognition, or device PIN.

## Files Created

### `apps/web/src/lib/webauthn.ts`
- `isWebAuthnAvailable()` - Browser support check
- `isPlatformAuthenticatorAvailable()` - Platform authenticator (biometric/PIN) check
- `registerCredential()` - Creates a new passkey with ES256/RS256, platform attachment, attestation=none
- `authenticateCredential()` - Verifies identity against stored credentials
- `StoredCredential` interface with id, rawId, publicKey (base64), label, timestamps
- Helper functions for ArrayBuffer/base64 conversion

### `apps/web/src/store/security-store.ts`
- Zustand persisted store for all advanced security features
- WebAuthn: credentials list, enabled flag, passkey-as-default toggle
- Duress password: enabled flag, hash storage (for F9.2)
- Key rotation: last rotation timestamp, reminder interval (for F9.3)
- Dead man's switch: enabled, days, action, contacts, last activity (for F9.4)
- Actions for all CRUD operations on each security feature

### `apps/web/src/components/security/PasskeyManager.tsx`
- Full passkey management UI: register, list, remove, test
- Browser support detection with fallback message
- Registration form with custom label input
- Credential list showing label, creation date, last used
- "Use passkey as default" toggle to bypass passcode
- Test authentication button for verification

## Architecture Decisions
- Uses Web Authentication API (navigator.credentials) directly, no third-party library
- Platform authenticator preferred (not cross-platform USB keys)
- Attestation set to 'none' since we verify locally, not server-side
- Credentials stored in Zustand with localStorage persistence
- Challenge generation uses crypto.getRandomValues (not server-round-trip, since local-first)
- Public key stored as base64-encoded SPKI for future server-side verification
- Security store consolidates all Phase 9 features for unified persistence
