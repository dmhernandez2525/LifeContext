# F5.4 Voice-Docs UX SDD

## Metadata
- Feature: F5.4 Voice-Docs UX
- Phase: 5
- Status: In Progress
- Owner: Web App
- Updated: 2026-02-16

## Goals
- Polish floating Ask Docs trigger with drag-to-reposition, snap-to-edge behavior, and strong z-index layering.
- Add spring-based open/close modal animation transitions.
- Add hands-free voice input using Web Speech API with clear noise-reduction hints.
- Add quick actions for top tasks: new entry, search, export, settings, and help.
- Add response feedback controls (thumbs up/down) and persistence.
- Add periodic NPS-style satisfaction prompts after interaction intervals.
- Add minimized pill mode with unread notification count.
- Add mobile-friendly haptic feedback for key interactions.
- Add first-visit onboarding tooltip for discoverability.
- Keep modal theme in sync with app light/dark mode.

## Constraints
- Keep component files under 300 lines by splitting trigger, modal, and logic helpers.
- Avoid forbidden patterns (`any`, `@ts-ignore`, `eslint-disable`, `console.*`).
- Preserve existing command parsing and navigation flows from F5.3.

## Architecture
- `AskDocsButton.tsx`
  - Orchestrates state, command handling, interaction tracking, and feature wiring.
- `HelpFloatingTrigger.tsx`
  - Floating button/pill trigger and onboarding tooltip entry point.
- `HelpAssistantModal.tsx`
  - Main modal UI, quick actions, feedback controls, NPS prompt, and voice input controls.
- `useFloatingTriggerPosition.ts`
  - Draggable trigger position handling with viewport clamping and edge snapping.
- `useSpeechRecognition.ts`
  - Browser speech-recognition wrapper and transcript/error state.
- `helpUxStorage.ts`
  - Local persistence for minimized state, unread count, feedback records, and NPS cadence.
- `helpHaptics.ts`
  - Touch-device vibration helper for interaction feedback.

## Storage Keys
- `lcc-help-trigger-position`
- `lcc-help-pill-minimized`
- `lcc-help-pill-unread`
- `lcc-help-onboarding-tooltip-seen`
- `lcc-help-feedback`
- `lcc-help-interaction-count`
- `lcc-help-last-nps-prompt-at`
- `lcc-help-nps-scores`

## Testing Plan
- E2E: floating trigger z-index and drag position persistence.
- E2E: modal animation frame cadence sampling.
- E2E: voice input transcription via speech-recognition mock.
- E2E: quick action routing.
- E2E: response feedback persistence.
- E2E: light/dark theme synchronization on modal.
