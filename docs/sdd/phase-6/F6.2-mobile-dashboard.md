# F6.2 Mobile Dashboard SDD

## Metadata
- Feature: F6.2 Mobile Dashboard
- Phase: 6
- Status: Complete
- Owner: Mobile App
- Updated: 2026-02-15

## Goals
- Refactor monolithic 583-line dashboard into modular <300-line components.
- Add daily summary card showing today's mood, energy, and entry count.
- Add 7-day streak heatmap with entry count and mood indicators.
- Add life score widget with five progress-bar dimensions.
- Add customizable card layout with visibility toggling and reordering.
- Add pull-to-refresh with haptic feedback.
- Add daily rotating thought-of-the-day and suggested prompt cards.
- Support deep linking from dashboard cards to relevant screens.

## Architecture

### Dashboard Components (`apps/mobile/src/components/dashboard/`)
- `dashboardTypes.ts` - Shared types: DashboardStats, RecentItem, DashboardCardConfig, DashboardCardId, StreakDay, LifeScoreDimension.
- `dashboardHelpers.ts` - Pure utility functions: formatRecordingTime, formatRelativeDate, calculateOverallProgress, getTodayStats, getStreakData, calculateStreakDays, getLifeScoreDimensions.
- `useDashboardData.ts` - Custom hook that loads all dashboard data from storage into a single state object.
- `ProgressRing.tsx` - Animated circular progress indicator showing context-built percentage.
- `StatCard.tsx` - Compact stat display with icon, value, and label.
- `QuickActionCard.tsx` - Horizontal-scroll action card with haptic feedback on press.
- `RecentActivityItem.tsx` - Activity list item with type-based icon/color and relative date.
- `DailySummaryCard.tsx` - Today view with mood emoji, energy level, and entry count.
- `StreakHeatmap.tsx` - 7-day heatmap grid showing daily entry counts and mood dots.
- `LifeScoreWidget.tsx` - Five-dimension life score with labeled progress bars and overall score.
- `ThoughtOfDayCard.tsx` - Daily rotating inspirational quote card.
- `SuggestedPromptCard.tsx` - Daily rotating journaling prompt with deep link to recording screen.
- `QuickActionsSection.tsx` - Horizontal scroll of quick action cards for Record, Journal, Brain Dump, AI Insights, Life Plan.
- `RecentActivitySection.tsx` - Recent activity list with "View All" deep link to timeline.
- `index.ts` - Barrel export for all dashboard components.

### Store (`apps/mobile/src/store/`)
- `useDashboardStore.ts` - Zustand store for card layout configuration (visibility, order), refresh state, and layout reset. Exports getVisibleCards() helper.

### Integration Point
- `apps/mobile/app/(tabs)/index.tsx` - Refactored to 170 lines. Composes all dashboard cards via a configurable renderer map driven by useDashboardStore card order/visibility. Adds RefreshControl with haptic feedback.

## Card System
Cards are rendered in a configurable order driven by `DashboardCardConfig[]` in the store. Each card has:
- `id` - Unique DashboardCardId
- `visible` - Whether the card is shown
- `order` - Sort position in the layout

Default card order: daily-summary, progress-ring, stats, streak, life-score, thought-of-day, quick-actions, recent-activity, suggested-prompt.

## Data Flow
1. `useDashboardData` loads recordings, journals, brain dumps, and tasks from MMKV storage.
2. Computes derived stats: today's mood/energy/entries, streak days, life score dimensions, overall progress.
3. Dashboard screen passes computed data to individual card components.
4. Pull-to-refresh triggers full data reload with haptic feedback.

## Testing Plan
- Unit: dashboardHelpers functions (formatRecordingTime, calculateOverallProgress, calculateStreakDays)
- Unit: useDashboardStore actions (toggleVisibility, reorderCard, resetLayout)
- Unit: getVisibleCards filtering and sorting
- Integration: useDashboardData loads and transforms storage data correctly
- Integration: pull-to-refresh triggers data reload
- E2E: dashboard renders all visible cards in configured order
- E2E: card visibility toggle hides/shows cards
- E2E: deep links from cards navigate to correct screens
